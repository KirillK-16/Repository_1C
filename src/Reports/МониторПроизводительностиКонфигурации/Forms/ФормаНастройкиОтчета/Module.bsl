
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
    
    Отчет.Конфигурация = ЭтотОбъект.Параметры.Конфигурация;
    Отчет.ПериодОтчета = ЭтотОбъект.Параметры.ПериодОтчета;
    Отчет.ПрофильКлючевыхОпераций = ЭтотОбъект.Параметры.ПрофильКлючевыхОпераций;
    Отчет.ТолькоКлючевыеОперацииПрофиля = ЭтотОбъект.Параметры.ТолькоКлючевыеОперацииПрофиля;
    Отчет.МинимальноеКоличествоБазДляРаспределения = ЭтотОбъект.Параметры.МинимальноеКоличествоБазДляРаспределения;
    Отчет.РежимРаботыКонфигурации = ЭтотОбъект.Параметры.РежимРаботыКонфигурации;
    Отчет.ИспользоватьБазовоеЗначение = ЭтотОбъект.Параметры.ИспользоватьБазовоеЗначение;
	Отчет.МинимальноеКоличествоЗамеров = ЭтотОбъект.Параметры.МинимальноеКоличествоЗамеров;
	Отчет.КлючеваяОперация = ЭтотОбъект.Параметры.КлючеваяОперация;
	Отчет.ОтборПоЧастойВерсииПлатформы = ЭтотОбъект.Параметры.ОтборПоЧастойВерсииПлатформы;
	Отчет.АнализироватьПлатформу = ЭтотОбъект.Параметры.АнализироватьПлатформу;
	СтатусИнформационнойБазы.ЗагрузитьЗначения(ЭтотОбъект.Параметры.СтатусИнформационнойБазы.ВыгрузитьЗначения());
    
    Если ЗначениеЗаполнено(ЭтотОбъект.Параметры.РаспределениеПользователей) Тогда
        РаспределениеПользователейИзXML(ЭтотОбъект.Параметры.РаспределениеПользователей);
    КонецЕсли;
            
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура ЗавершитьРедактирование(Команда)
    
    ПараметрыЗакрытия = Новый Структура;
    ПараметрыЗакрытия.Вставить("Конфигурация", Отчет.Конфигурация);
    ПараметрыЗакрытия.Вставить("ПериодОтчета", Отчет.ПериодОтчета);
    ПараметрыЗакрытия.Вставить("ПрофильКлючевыхОпераций", Отчет.ПрофильКлючевыхОпераций);
    ПараметрыЗакрытия.Вставить("ТолькоКлючевыеОперацииПрофиля", Отчет.ТолькоКлючевыеОперацииПрофиля);
    ПараметрыЗакрытия.Вставить("МинимальноеКоличествоБазДляРаспределения", Отчет.МинимальноеКоличествоБазДляРаспределения);
    ПараметрыЗакрытия.Вставить("РежимРаботыКонфигурации", Отчет.РежимРаботыКонфигурации);
    ПараметрыЗакрытия.Вставить("ИспользоватьБазовоеЗначение", Отчет.ИспользоватьБазовоеЗначение);
	ПараметрыЗакрытия.Вставить("МинимальноеКоличествоЗамеров", Отчет.МинимальноеКоличествоЗамеров);
	ПараметрыЗакрытия.Вставить("КлючеваяОперация", Отчет.КлючеваяОперация);
	ПараметрыЗакрытия.Вставить("ОтборПоЧастойВерсииПлатформы", Отчет.ОтборПоЧастойВерсииПлатформы);
	ПараметрыЗакрытия.Вставить("АнализироватьПлатформу", Отчет.АнализироватьПлатформу);
	ПараметрыЗакрытия.Вставить("СтатусИнформационнойБазы", СтатусИнформационнойБазы.ВыгрузитьЗначения());
    ПараметрыЗакрытия.Вставить("РаспределениеПользователей", РаспределениеПользователейВXML()); 
    
    ЭтотОбъект.Закрыть(ПараметрыЗакрытия);
    
КонецПроцедуры

&НаКлиенте
Процедура Отмена(Команда)
    ЭтотОбъект.Закрыть();
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Функция РаспределениеПользователейВXML()
    
    ТаблицаЗначений = РеквизитФормыВЗначение("РаспределениеПользователей", Тип("ТаблицаЗначений"));
    
    Поток = Новый ЗаписьXML();
	Поток.УстановитьСтроку();
	СериализаторXDTO.ЗаписатьXML(Поток, ТаблицаЗначений);
    
	Возврат Поток.Закрыть();
    
КонецФункции

&НаСервере
Процедура РаспределениеПользователейИзXML(СтрокаXML)
    
    ЧтениеXML = Новый ЧтениеXML;
	ЧтениеXML.УстановитьСтроку(СтрокаXML);
	
	ТаблицаЗначений = СериализаторXDTO.ПрочитатьXML(ЧтениеXML);
    
    ЗначениеВРеквизитФормы(ТаблицаЗначений, "РаспределениеПользователей");
    
КонецПроцедуры

#КонецОбласти
