<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="__STYLE__"></link><meta name="GENERATOR" content="MSHTML 9.00.8112.16476"></meta></head><body>
<h1>Контроль производительности</h1>
<p>Это сообщение означает, что значение Apdex для данной ключевой операции меньше, чем необходимо для данной ключевой операции. </p>
<p>Для решения задачи рекомендуется использовать <a href="http://www.v8.1c.ru/expert/pmc/pmc_overview.htm" target="_blank">«Центр управления производительностью»</a>, входящий в состав <a href="http://www.v8.1c.ru/expert/etp.htm" target="_blank">«1С:Корпоративного инструментального пакета»</a>.</p>
<h2>Настройки мониторинга</h2>
<h3>1. Подключитесь к исследуемой информационной базе при помощи ЦУП в режиме «Мониторинг».</h3>
<p>Подробные инструкции по подключению см. в книге «1С:Корпоративный инструментальный пакет 8. Редакция 1.1. Руководство по использованию», стр. 37.</p>
<h3>2. Включите сбор следующих показателей производительности:</h3>
<ul><li>Запросы \ Максимальное время выполнения запроса; 
</li><li>Запросы \ Среднее время выполнения запроса; 
</li><li>Ожидания на блокировках \ Только блокировки СУБД \ Среднее время ожидания на блокировке СУБД; 
</li><li>Ожидания на блокировках \ Только блокировки СУБД \ Количество таймаутов; 
</li><li>Ожидания на блокировках \ Только блокировки 1С \ Среднее время ожидания на блокировке 1С; 
</li><li>Взаимоблокировки \ Количество взаимоблокировок. </li></ul><p>Подробные инструкции см. там же на стр. 41. </p>
<h3>3. Включите запись всех показателей производительности</h3>
<p>Подробные инструкции см. там же на стр. 45. </p>
<h2>Настройки расписания анализа симптомов проблем</h2>
<p>Необходимо регулярно контролировать собранные ЦУП'ом показатели производительности системы на предмет наличия симптомов проблем производительности.</p>
<p>Рекомендуемая частота контроля производительности - 1 раз в день.</p>
<h2>Поиск симптомов проблем</h2>
<p>Для оценки производительности системы, необходимо проанализировать результаты мониторинга на наличие симптомов проблем производительности.</p>
<p>Все имеющиеся симптомы следует зарегистрировать в данной форме. После этого контрольная процедура перейдет в режим оптимизации системы.</p>
<h2>Симптомы проблем производительности</h2>
<h3>Симптом 1</h3>
<p>Значения показателя «Среднее время ожидания на блокировке СУБД» близки к значениям показателя «Среднее время выполнения запроса». Это означает, что большую часть времени система простаивает в ожиданиях на блокировках СУБД. Если время ожиданий составляет 50% от времени выполнения запросов, то проблему необходимо расследовать. Если это соотношение еще больше, то проблема является серьезной.</p>
<h3>Симптом 2</h3>
<p>Не равны нулю значения следующих показателей:</p>
<ul><li>«Количество взаимоблокировок»; 
</li><li>«Количество таймаутов». </li></ul><p>Это означает, что в системе наблюдаются взаимоблокировки и/или таймауты, то есть пользователи получают соответствующие сообщения об ошибках.</p>
<h3>Симптом 3</h3>
<p>В течение длительного времени наблюдается практически линейный рост показателя «Максимальное время выполнения запроса», после чего следует его падение до обычных значений. Это означает, что в системе выполнялся один или несколько длительных запросов, которые вероятно могут быть оптимизированы.</p>
<h3>Симптом 4</h3>
<p>Наблюдается постепенный значительный рост или внезапный «всплеск» значений следующих показателей:</p>
<ul><li>«Среднее время выполнения запроса»; 
</li><li>«Среднее время ожидания на блокировке СУБД»; 
</li><li>«Среднее время ожидания на блокировке 1С». </li></ul><h2>Разбор проблем производительности и оптимизация системы</h2>
<p>При обнаружении симптомов проблем необходимо провести их разбор и оптимизацию системы. Этот процесс состоит из следующих основных этапов:</p>
<ul><li>Сбор аналитической информации о проблемах производительности; 
</li><li>Цикл по основным проблемам производительности в порядке убывания их важности (степени влияния на общую производительность системы); 
</li><li>Анализ проблем производительности, обнаруженных в данной строке кода. </li></ul><h2>Сбор аналитической информации о проблемах производительности</h2>
<p>На этом этапе необходимо собрать аналитическую информацию по проблемам производительности при помощи Центра управления производительностью.</p>
<p>Для этого следует выполнить следующую последовательность действий:</p>
<h3>1. Добавить к списку показателей все показатели производительности, входящие в группу «Анализ».</h3>
<ul><li>Анализ запросов 
</li><li>Анализ ожиданий на блокировках 
</li><li>Анализ взаимоблокировок </li></ul><p>Вы можете не добавлять в список показатель «Анализ взаимоблокировок» в том случае, если уверены, что взаимоблокировок в системе нет. Например, система работала в однопользовательском режиме или в многопользовательском режиме не наблюдалось отличное от нуля значения показателя «Количество взаимоблокировок».</p>
<p>Вы можете не добавлять в список показатель «Анализ ожиданий на блокировках» в том случае, если вы уверены, что в системе нет ожиданий на блокировках. Например, система работала в однопользовательском режиме или в многопользовательском режиме значения показателей «Суммарное время ожидания на блокировках СУБД» и «Суммарное время ожидания на блокировках 1С» было близко к нулю. </p>
<p>Это позволит уменьшить количество информации, собираемой ЦУП, и сократит время ее обработки. </p>
<h3>2. Включить запись всех трех показателей</h3>
<p>Запись показателей необходимо включать в то время, когда в системе наблюдаются проблемы производительности. Если проблемы наблюдаются не всегда, а только эпизодически (в определенных режимах работы, в период предельной загрузки системы и т.д.), то следует включать сбор аналитической информации именно в это время.</p>
<p><b>ВНИМАНИЕ!!!</b> Включение записи аналитических показателей может привести к замедлению работы системы. </p>
<h3>3. Собирать аналитическую информацию в течение необходимого и достаточного периода времени</h3>
<p>Период сбора аналитической информации необходимо выбирать исходя из следующих факторов: </p>
<ul><li>Время сбора аналитической информации не может быть менее 1 минуты. Рекомендуемое минимальное время: 2 минуты. 
</li><li>За время сбора информации должна успеть проявиться значительная часть наблюдающихся в системе проблем. То есть, период сбора информации должен быть достаточно большим. 
</li><li>Чем дольше собирается аналитическая информация, тем дольше она будет анализироваться. То есть, период сбора информации не должен быть слишком большим. </li></ul><p>При наличии в системе серьезных проблем производительности, как правило, достаточно включить запись аналитических показателей на 10-15 минут.</p>
<h3>4. Отключить запись аналитических показателей</h3>
<p>После отключения записи аналитических показателей ЦУП произведет анализ собранных данных и поместит результаты анализа в свою информационную базу. Время анализа данных пропорционально периоду сбора аналитической информации и может быть значительным.</p>
<h2>Цикл по основным проблемам производительности</h2>
<p>Для анализа проблем производительности и оптимизации системы необходимо выполнить следующую последовательность действий:</p>
<h3>1. Перейти в режим анализа собранной информации</h3>
<p>Для этого необходимо подключиться к исследуемой базе в режиме «Просмотр». Если отключение мониторинга нежелательно (необходимо обеспечить постоянный мониторинг производительности в исследуемой базе), то следует открыть новое соединение с информационной базой ЦУП и подключиться к исследуемой базе в режиме «Просмотр».</p>
<h3>2. Выбрать период времени, на котором собиралась аналитическая информация</h3>
<p>Для упрощения работы с различными периодами времени рекомендуется использовать закладки. См. «Руководство по использованию», стр. 60.</p>
<h3>3. Открыть форму анализа проблем производительности</h3>
<h3>4. Анализировать источники проблем в разрезе строк кода конфигурации, начиная с наиболее «тяжелых» проблем</h3>
<p>Следует анализировать проблемы в разрезе строк кода конфигурации. Для справки во время анализа можно использовать информацию о проблемах в разрезе структуры данных.</p>
<p>Источники проблем (строки кода) следует анализировать сверху вниз – в порядке убывания общего веса проблем, относящихся к данному источнику.</p>
<p>Для каждого источника (строки кода конфигурации) следует провести анализ проблем, обнаруженных в данной строке кода «Центром управления производительностью».</p>
<h2>Анализ проблем, обнаруженных в данной строке кода</h2>
<p>Откройте второй уровень дерева источников проблем для выбранной строки кода конфигурации. Он отображает все виды проблем, зафиксированные в данной строке кода и вес проблем каждого вида.</p>
<p>Виды проблем расположены в порядке убывания веса. Пользуясь рекомендациями, данными ниже по ссылкам, проведите анализ и оптимизацию кода конфигурации и структуры метаданных в зависимости от вида проблем, обнаруженного ЦУП в данной строке кода. Если в данной строке обнаружены проблемы разных видов, то рекомендуется начинать анализ с проблем, имеющих больший вес.</p>
<ul><li><a href="http://kb.1c.ru/articleView.jsp?id=44" target="_blank">Типичные причины неоптимальной работы запросов и методы оптимизации</a> 
</li><li><a href="http://kb.1c.ru/articleView.jsp?id=45" target="_blank">Типичные причины возникновения избыточных блокировок и методы оптимизации</a> 
</li><li><a href="http://kb.1c.ru/articleView.jsp?id=46" target="_blank">Анализ и устранение взаимоблокировок</a></li></ul><h2>Динамика изменения Apdex</h2>
<p>Инструмент "Анализ и устранение проблем производительности", ссылку на который можно найти на панели справа, предназначен для анализа динамики изменения показателя Apdex. </p>
<p>В верхней части окошка предлагается указать исследуемую информационную базу и интересуемый временной отрезок и шаг дискретной временной решётки.</p>
<p>После нажатия на кнопку "Обновить показатели производительности" на вкладке "Таблица" появится таблица. Каждая колонка этой таблицы представляет собой временную развёртку значений Apdex по соответствующей ключевой операции с шагом указанным в поле "Шаг".</p>
<p><img src="_files/SNAGHTML1f871efa.PNG"></img></p>
<p>На вкладке "Диаграмма" можно увидеть графическую интерпретацию таблицы.</p>
<p><img src="_files/SNAGHTML1f86d1c5.PNG"></img></p></body></html>